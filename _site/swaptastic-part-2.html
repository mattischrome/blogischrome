<!DOCTYPE html><html lang="en" ><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Jekyll v4.0.0" /><meta property="og:title" content="Swaptastic Part 2" /><meta name="author" content="Matthew Dorey" /><meta property="og:locale" content="en_US" /><meta name="description" content="As a follow-up to my post about the Euro 2016 Panini Stickers, I’ve now completed the collection with the help of an online swapping site and by buying the last 39 stickers directly from Panini. I also managed to write a new simulator, this time with additional collectors involved." /><meta property="og:description" content="As a follow-up to my post about the Euro 2016 Panini Stickers, I’ve now completed the collection with the help of an online swapping site and by buying the last 39 stickers directly from Panini. I also managed to write a new simulator, this time with additional collectors involved." /><link rel="canonical" href="http://localhost:4000/swaptastic-part-2" /><meta property="og:url" content="http://localhost:4000/swaptastic-part-2" /><meta property="og:site_name" content="Mattischrome" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2016-06-29T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Swaptastic Part 2" /><meta name="twitter:site" content="@mattischrome" /><meta name="twitter:creator" content="@mattischrome" /> <script type="application/ld+json"> {"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/swaptastic-part-2"},"url":"http://localhost:4000/swaptastic-part-2","headline":"Swaptastic Part 2","dateModified":"2016-06-29T00:00:00+01:00","datePublished":"2016-06-29T00:00:00+01:00","author":{"@type":"Person","name":"Matthew Dorey"},"description":"As a follow-up to my post about the Euro 2016 Panini Stickers, I’ve now completed the collection with the help of an online swapping site and by buying the last 39 stickers directly from Panini. I also managed to write a new simulator, this time with additional collectors involved.","@type":"BlogPosting","@context":"https://schema.org"}</script><title> Swaptastic Part 2 - Mattischrome</title><link rel="shortcut icon" href="/favicon.png"><link rel="alternate" type="application/atom+xml" title="Mattischrome" href="/atom.xml"><link rel="alternate" type="application/json" title="Mattischrome" href="http://localhost:4000/feed.json" /><link rel="sitemap" type="application/xml" title="sitemap" href="/sitemap.xml" /><style> *,:after,:before{box-sizing:border-box;background-color:inherit;color:inherit;margin:0;padding:0}body{font-family:system-ui, sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;line-height:1.5;font-size:1rem;color:#16171a}nav ul{border-right:1px solid #edf2f7}a{color:#000;text-decoration-skip-ink:auto;text-decoration:underline}pre{margin:.5rem 0;padding:.5rem}.post p{margin:.5rem 0}.post h1,.post h2,.post h3,.post h4{margin:1rem 0}.post h2:first-child,.project h2:first-child,.photo h2:first-child{margin-top:0}.meta{margin:2rem 0}code,pre{background:#ecedee}code{padding:.1rem}pre code{border:none}pre{padding:1rem;overflow-x:auto}img{max-width:100%}hr{background:#000;height:1px;border:0}header{flex-basis:10rem;flex-grow:1;position:relative}header a{text-decoration:none}header li{margin-bottom:.2rem;text-align:right;margin-right:2rem}header a.active{font-weight:bold}header,section{padding:1rem}blockquote{font-style:italic;border-left:5px solid #ececec;padding-left:1rem}h1,h2,h3,h4,h5{line-height:1;margin:1rem 0;font-weight:600}section h1:first-child{margin-top:0}strong,b{font-weight:bold}.photos ul{list-style:none}.photos li{margin-bottom:1.5rem}.photo picture,.project picture{margin-bottom:0.5rem}.posts ul,header ul{list-style:none}.posts li{align-items:center;display:flex;justify-content:space-between;margin-bottom:.5rem}.posts li a,.posts li div,.projects li a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-decoration:none}.posts li time,.projects li time{padding-left:1rem;white-space:nowrap;font-variant-numeric:tabular-nums}main{display:flex;flex-wrap:wrap;max-width:60rem;margin:2rem auto;padding:1rem}@media screen and (max-width: 45rem){header li{display:inline;margin-right:1rem}.logo{padding-bottom:1rem}header ul{border-bottom:1px solid #edf2f7;padding-bottom:2rem}nav ul{border-right:0px}.photos ul{margin-top:0.5rem}}section{flex-basis:0;flex-grow:999;min-width:70%;display:flex;flex-direction:column}figcaption{font-size:smaller}.post-nav{display:flex;justify-content:space-between;flex-wrap:wrap}.post-nav p{flex:1 1 0;width:45%}.post-nav p:first-child{padding-right:0.5em}.post-nav p:last-child{padding-left:0.5em;text-align:right}</style></head><body><main role="main"><header role="banner"> <!--<h1 class="logo">Mattischrome</h1>--><nav role="navigation"><ul><li><a href="/" >mattischrome</a></li><li><a href="/about" >About</a></li><li><a href="/search" >Search</a></li><li><a href="/atom.xml" >Rss</a></li></ul></nav></header><section class="post"><h2>Swaptastic Part 2</h2><p>As a follow-up to my post about the <a href="/euro-2016-panini-stickers/">Euro 2016 Panini Stickers</a>, I’ve now completed the collection with <a href="/swaptastic-part-1/">the help of an online swapping site</a> and by buying the last 39 stickers directly from Panini. I also managed to write a new simulator, this time with additional collectors involved.</p><p>I assume that each of N collectors will buy a packet of stickers and add any new stickers to their album. Then they attempt to swap any leftovers with the rest of their friends. The intersect function in R makes this pretty easy to code up. Every collector who finishes the album stops buying stickers.</p><p>Here’s the R code for a single simulation of the swapping algorithm, with defaults for the Euro 2016 album:</p><pre><code class="language-r">stickerswaps &lt;- function(number.collectors=2, number.stickers=680,
pack.size=5, packs.purchased=1, target.collections=1, cutoff=50)
{
  pack.price&lt;-0.5
  collections&lt;-array(0,c(number.collectors,number.stickers))
  number.complete.collections&lt;-0
  total.number.swapped&lt;-0
  number.rounds&lt;-1

  # we set a flag to once a collector has completed the album
  # later we can change this to when all but one collector has completed

  while(number.complete.collections&lt;target.collections)
  {
    for(i in 1:number.collectors)
    {
      if(sum(collections[i,]!=0)&lt;=number.stickers-cutoff)
      {
        new.stickers&lt;-sample(1:number.stickers,pack.size*packs.purchased)
        collections[i,new.stickers]&lt;-collections[i,new.stickers]+1
      }
    }

    # After acquiring new stickers, each possible pair of collectors exchanges their swaps
    for (i in 1:number.collectors-1)
    {
      potential.swappers=(i+1):number.collectors
      for (j in potential.swappers)
      {
        # each collector works out which stickers they need
        need.i&lt;-which(collections[i,]==0)
        need.j&lt;-which(collections[j,]==0)
        # each collector works out their swaps
        swaps.i&lt;-which(collections[i,]&gt;1)
        swaps.j&lt;-which(collections[j,]&gt;1)
        # now work out what j has for i
        exchange.jtoi&lt;-intersect(swaps.j,need.i)
        # and what i has for j
        exchange.itoj&lt;-intersect(swaps.i,need.j)
        # how many do we swap?
        number.swapped&lt;-min(c(length(exchange.itoj),length(exchange.jtoi)))
        # update the collections and the total number swapped across all pairs
        if (number.swapped&gt;0) {
          total.number.swapped&lt;-total.number.swapped+number.swapped
          # NB this assumes collectors always swap the lowest number stickers first
          collections[i,exchange.jtoi[1:number.swapped]]&lt;-collections[i,exchange.jtoi[1:number.swapped]]+1
          collections[j,exchange.jtoi[1:number.swapped]]&lt;-collections[j,exchange.jtoi[1:number.swapped]]-1
          collections[j,exchange.itoj[1:number.swapped]]&lt;-collections[j,exchange.itoj[1:number.swapped]]+1
          collections[i,exchange.itoj[1:number.swapped]]&lt;-collections[i,exchange.itoj[1:number.swapped]]-1
        }
      }
    } # end of swaps

    # increment the number of rounds
    number.rounds&lt;-number.rounds+1

    # calculate the number of complete collections
    number.complete.collections=sum(rowSums(collections!=0)&gt;=(number.stickers-cutoff))
  } # end of while loop

  return(c(number.rounds*packs.purchased,total.number.swapped/number.collectors))
}
</code></pre><p>What is the benefit to a collector of having a friend to swap with? The figure below compares someone collecting alone to a collector with one single friend to swap with. As I mentioned last time, the single collector has to buy about 340 packets of stickers on average. Meanwhile, someone with a sticker swapping buddy has to buy about 240 packs of stickers on average - that’s a hundred fewer packets of stickers on average. The value of a friend is about £50!</p><p><img src="/assets/images/other/1vs2collectors.jpg" alt="" /></p><p>I then increased the number of collectors. As you can see from the figure below, the distribution creeps ever leftward and tightens up around the mean. The larger your friendship group, the closer you get to only having to buy enough packets of stickers to fill the album. This makes sense if the stickers are equally rare: you should be able to exchange your swaps with those belonging to your friends. Note that this shows the number of packets that the first collector has to buy.</p><p><img src="/assets/images/other/FirstCollector.jpg" alt="" /></p><p>Now let’s look at a similar graph for the penultimate collector to finish. I chose the second-to-last collector because the last person has no one to swap with. You will see that these distributions overlap a lot more. The unluckiest player in the 10 collector scenario has to buy as many stickers as the luckiest players in the 3 collector scenario. As each collector finishes it becomes an N-1 collector scenario for the remaining collectors and this will involve buying more packets.</p><p><img src="/assets/images/other/PenultimateCollector.jpg" alt="" /></p><p>Finally, let’s look at the distributions for how many stickers each collector has to collect when there are five of them. On average the last collector to finish has to buy about forty more packets of stickers than the first collector to finish. The final collector also has a much wider range of possible outcomes as it will depend on how close to finishing she is when her friends complete their collections.</p><p><img src="/assets/images/other/All5Collectors.jpg" alt="" /></p><p>Part 3 will look at what happens when the stickers are not equally rare.</p><span class="meta"><time datetime="2016-06-29T00:00:00+01:00">June 29, 2016</time> &middot; <a href="/tag/Football">Football</a>, <a href="/tag/Stats">Stats</a>, <a href="/tag/Modelling">Modelling</a>, <a href="/tag/Programming">Programming</a>, <a href="/tag/R">R</a></span><hr/><div class="post-nav"><p> <a href="/in-the-space-between-this-and-that">&#8672;&nbsp;In the space between this and that</a></p><p> <a href="/album-digest-june-2016">Album Digest, June 2016&nbsp;&#8674;</a></p></div><!--<span class="meta"><time datetime="2016-06-29T00:00:00+01:00">June 29, 2016</time> &middot; <a class="post" href="/tag/Football">Football</a>, <a class="post" href="/tag/Stats">Stats</a>, <a class="post" href="/tag/Modelling">Modelling</a>, <a class="post" href="/tag/Programming">Programming</a>, <a class="post" href="/tag/R">R</a></span> --></section></main></body></html>
